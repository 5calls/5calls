# Settings in the [build] context are global and are applied to all contexts
# unless otherwise overridden by more specific contexts.
[build]
base = "react/" # the base is react because that's how we can cache node_modules and reduce the build times
command = "yarn build-js && yarn build-content && cd .. && hugo -b $DEPLOY_URL" 
ignore = "false" # don't skip builds when they only have hugo edits (outside of base)
publish = "/final/" # we publish back into a directory *inside* of base because we can't specify a publish root above it
[build.environment]
# set hugo version for consistency
HUGO_VERSION = '0.74.3'
# need yarn installed manually
NETLIFY_USE_YARN = 'true'
# don't care about ruby, but the default installs a new version for each build
RUBY_VERSION = '2.6.2'
YARN_VERSION = '1.22.5'

# dunno if we can measure how many clients are still using this old endpoint?
[[redirects]]
from = "/report"
status = 200
to = "https://api.5calls.org/v1/report"

[[redirects]]
from = "/more"
status = 301
to = "/all/"
