# Settings in the [build] context are global and are applied to all contexts
# unless otherwise overridden by more specific contexts.
[build]
# netlify won't install yarn unless base is a react project
# so we symlink the important bits into the root, at build command time yarn is already installed and node modules is ready
command = "cd react; yarn build-js; yarn build-content; cd ..; hugo -b https://test.5calls.org"
publish = "public/"
[build.environment]
# set hugo version for consistency
HUGO_VERSION = '0.74.3'
# need yarn installed manually
NETLIFY_USE_YARN = 'true'
# don't care about ruby, but the default installs a new version for each build
RUBY_VERSION = '2.6.2'
YARN_VERSION = '1.22.5'

# dunno if we can measure how many clients are still using this old endpoint?
[[redirects]]
from = "/report"
status = 200
to = "https://api.5calls.org/v1/report"

[[redirects]]
from = "/more"
status = 301
to = "/all/"
